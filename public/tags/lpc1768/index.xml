<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>LPC1768 on Sakis Kasampalis - Personal homepage</title>
    <link>http://localhost:1313/tags/lpc1768/</link>
    <description>Recent content in LPC1768 on Sakis Kasampalis - Personal homepage</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sun, 15 Mar 2015 18:35:00 +0000</lastBuildDate>
    <atom:link href="http://localhost:1313/tags/lpc1768/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>Playing with microcontrollers</title>
      <link>http://localhost:1313/blog/2015-03-15-playing-with-microcontrollers/</link>
      <pubDate>Sun, 15 Mar 2015 18:35:00 +0000</pubDate>
      <guid>http://localhost:1313/blog/2015-03-15-playing-with-microcontrollers/</guid>
      <description>&lt;div dir=&#34;ltr&#34; style=&#34;text-align: left;&#34; trbidi=&#34;on&#34;&gt;The last training course that I followed was about programming microcontrollers. The course was given by Leon van Snippenberg, who has very good expertise in microcontrollers.&lt;br /&gt;&lt;br /&gt;For the practical part of the course we used the Microchip dsPIC33F, a 16-bit architecture 40 MHZ microcontroller (system on a chip solution). I admit that I&#39;m not very fond of this proprietary platform, so I enjoyed the theoretical part of the course much more than the practical. I would be more excited if we have used an open hardware solution like arduino, Raspberry Pi, or something comparable.&lt;br /&gt;&lt;br /&gt;A few highlights from the course:&lt;br /&gt;&lt;ul style=&#34;text-align: left;&#34;&gt;&lt;li&gt;A three-operand assembly instruction does not necessarily mean that three registers are used. For example &lt;span style=&#34;font-family: Courier New, Courier, monospace;&#34;&gt;ADD W0, W1, W0&lt;/span&gt; uses only one register.&lt;/li&gt;&lt;li&gt;Most microcontrollers use the Harvard instead of the&amp;nbsp;&lt;span style=&#34;color: #252525; font-family: sans-serif; font-size: 14px; line-height: 22px;&#34;&gt;Von Neumann&lt;/span&gt;&amp;nbsp;architecture. This means that there are two distinct address buses, as well as two data buses (instead of one address and one data bus).&lt;/li&gt;&lt;li&gt;When writing code in assembly we should avoid thinking about code optimisation, since the code is usually very fast to execute (but very slow to produce).&lt;/li&gt;&lt;li&gt;A common problem when programming microcontrollers is &lt;a href=&#34;http://www.piclist.com/techref/readmodwrite.htm&#34;&gt;read-modify-write&lt;/a&gt;. One way to solve it is using shadow registers.&lt;/li&gt;&lt;li&gt;When programming a microcontroller using a C interface and interrupts, it is very important to use the &lt;span style=&#34;font-family: Courier New, Courier, monospace;&#34;&gt;volatile&lt;/span&gt; keyword to disable optimisations that might remove code that seems to be dead but is actually used. Because of that, it is also very important to test the code with all compiler optimisation levels enabled, to ensure that it doesn&#39;t break.&lt;/li&gt;&lt;li&gt;The hardware timers of a platform do not need to follow the same architecture with the processor. For example a platform might use a 16-bit processor with 32-bit timers.&lt;/li&gt;&lt;li&gt;Buffers and interrupts are used to solve communication problems between different devices (e.g. a computer communicating with a microcontroller using the serial port).&lt;/li&gt;&lt;li&gt;When dealing with non-deterministic problems, disabling interrupts is the most favoured solution.&lt;/li&gt;&lt;li&gt;Using a real-time operating system (RTOS) simplifies programming, because we avoid the need to write complex state machines and custom schedulers (those problems are already solved in the RTOS).&lt;/li&gt;&lt;li&gt;Multicore support in RTOS is a challenge (unsolved problem?).&lt;/li&gt;&lt;/ul&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;We (me and my colleague) challenged Leon by questioning why would one prefer a much more expensive solution like the dsPIC* family of Microchip instead of Raspberry Pi or arduino. The price of the latest Pi is unbeatable. The response was that we should use whatever fits our purpose, and that the Pi manages to achieve such a low price because its makers can estimate in advance the minimum numbers of units that will be sold. Those manufacturing deals are critical in forming the end price of a prototyping platform.&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;So far I only own an mbed LPC1768 and I&#39;m very satisfied with it. I hope that I&#39;ll build some more advanced prototypes in the future, but you have to start from something. I began with flashing LEDs&lt;br /&gt;&lt;br /&gt;&lt;/div&gt;&lt;div&gt;&lt;iframe allowfullscreen=&#34;&#34; frameborder=&#34;0&#34; height=&#34;889&#34; mozallowfullscreen=&#34;&#34; src=&#34;https://player.vimeo.com/video/120307094&#34; webkitallowfullscreen=&#34;&#34; width=&#34;500&#34;&gt;&lt;/iframe&gt;&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Continued with adding some basic components like a button&lt;br /&gt;&lt;br /&gt;&lt;iframe allowfullscreen=&#34;&#34; frameborder=&#34;0&#34; height=&#34;889&#34; mozallowfullscreen=&#34;&#34; src=&#34;https://player.vimeo.com/video/120957456&#34; webkitallowfullscreen=&#34;&#34; width=&#34;500&#34;&gt;&lt;/iframe&gt;&lt;/div&gt;&lt;div&gt;&lt;br /&gt;&lt;br /&gt;And at some point I built my first practical prototype: a darkness-activated LED&lt;br /&gt;&lt;br /&gt;&lt;/div&gt;&lt;iframe allowfullscreen=&#34;&#34; frameborder=&#34;0&#34; height=&#34;889&#34; mozallowfullscreen=&#34;&#34; src=&#34;https://player.vimeo.com/video/120970019&#34; webkitallowfullscreen=&#34;&#34; width=&#34;500&#34;&gt;&lt;/iframe&gt; &lt;br /&gt;Isn&#39;t that nice? In my future posts the plan is to spend more time on explaining the code of prototypes like the last one. For now you can check my &lt;a href=&#34;http://developer.mbed.org/users/faif/&#34;&gt;mbed repository&lt;/a&gt; page.&lt;/div&gt;</description>
    </item>
    <item>
      <title>mbed USB voltmeter</title>
      <link>http://localhost:1313/blog/2013-07-28-mbed-usb-voltmeter/</link>
      <pubDate>Sun, 28 Jul 2013 20:52:00 +0000</pubDate>
      <guid>http://localhost:1313/blog/2013-07-28-mbed-usb-voltmeter/</guid>
      <description>&lt;div dir=&#34;ltr&#34; style=&#34;text-align: left;&#34; trbidi=&#34;on&#34;&gt;USB communication with mbed is easy. That&#39;s because USB is the default protocol used to transfer programs from a computer to an mbed.&lt;br /&gt;&lt;br /&gt;In this prototype I measure the analog value of a pot, I convert it to  voltage, and finally I use USB to print it on my computer&#39;s  screen. That&#39;s a simplistic voltage meter! Here&#39;s the schematic:&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;table align=&#34;center&#34; cellpadding=&#34;0&#34; cellspacing=&#34;0&#34; class=&#34;tr-caption-container&#34; style=&#34;margin-left: auto; margin-right: auto; text-align: center;&#34;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-zjXcdWLTPi8/UfVJyejZJTI/AAAAAAAAAG4/g1aEkW9UG1w/s1600/voltmeter-schematic.jpg&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;&lt;img border=&#34;0&#34; height=&#34;207&#34; src=&#34;https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2F4.bp.blogspot.com%2F-zjXcdWLTPi8%2FUfVJyejZJTI%2FAAAAAAAAAG4%2Fg1aEkW9UG1w%2Fs1600%2Fvoltmeter-schematic.jpg&amp;amp;container=blogger&amp;amp;gadget=a&amp;amp;rewriteMime=image%2F*&#34; width=&#34;400&#34; /&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class=&#34;tr-caption&#34; style=&#34;text-align: center;&#34;&gt;USB voltage meter schematic. Image courtesy of Bert Van Dam&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div class=&#34;separator&#34; style=&#34;clear: both; text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-PDXtSfs8K2E/UfQjbnRkuyI/AAAAAAAAAGo/L5tAUyAeiWo/s1600/usb-voltmeter.jpg&#34; style=&#34;margin-left: 1em; margin-right: 1em;&#34;&gt;&lt;br /&gt;&lt;/a&gt;&lt;/div&gt;&lt;br /&gt;And a picture of the actual circuit:&lt;br /&gt;&lt;br /&gt;&lt;table align=&#34;center&#34; cellpadding=&#34;0&#34; cellspacing=&#34;0&#34; class=&#34;tr-caption-container&#34; style=&#34;margin-left: auto; margin-right: auto; text-align: center;&#34;&gt;&lt;tbody&gt;&lt;tr&gt;&lt;td style=&#34;text-align: center;&#34;&gt;&lt;a href=&#34;http://4.bp.blogspot.com/-PDXtSfs8K2E/UfQjbnRkuyI/AAAAAAAAAGo/L5tAUyAeiWo/s1600/usb-voltmeter.jpg&#34; style=&#34;margin-left: auto; margin-right: auto;&#34;&gt;&lt;img border=&#34;0&#34; height=&#34;640&#34; src=&#34;https://images-blogger-opensocial.googleusercontent.com/gadgets/proxy?url=http%3A%2F%2F4.bp.blogspot.com%2F-PDXtSfs8K2E%2FUfQjbnRkuyI%2FAAAAAAAAAGo%2FL5tAUyAeiWo%2Fs1600%2Fusb-voltmeter.jpg&amp;amp;container=blogger&amp;amp;gadget=a&amp;amp;rewriteMime=image%2F*&#34; width=&#34;480&#34; /&gt;&lt;/a&gt;&lt;/td&gt;&lt;/tr&gt;&lt;tr&gt;&lt;td class=&#34;tr-caption&#34; style=&#34;text-align: center;&#34;&gt;USB voltage meter circuit&lt;/td&gt;&lt;/tr&gt;&lt;/tbody&gt;&lt;/table&gt;&lt;div style=&#34;text-align: left;&#34;&gt;&lt;br /&gt;Note that the pot is used just for testing purposes. It can actually be replaced by any other part. Just make sure that you&#39;re not trying to measure voltage &amp;gt; 3.3 volts, or your mbed is in danger!&lt;/div&gt;&lt;h3 style=&#34;text-align: left;&#34;&gt;The code &lt;/h3&gt;&lt;div style=&#34;text-align: left;&#34;&gt;First the header file. It defines the USB connection, the analog input pin used to read the pot&#39;s value, a few constants, and a function that will be used for converting the pot&#39;s value from [0 - 1] to the voltage [0 - 3.3] volts.&lt;/div&gt;&lt;br /&gt;&lt;script src=&#34;https://gist.github.com/faif/6099348.js?file=voltmeter.h&#34;&gt;&lt;/script&gt;&lt;br /&gt;And the source file. It contains the body of the conversion function, two terminal control commands for clearing the screen and moving to the top, and the commands for reading the pot&#39;s value and printing it (together with its voltage) to the terminal through the USB port.&lt;br /&gt;&lt;br /&gt;&lt;script src=&#34;https://gist.github.com/faif/6099348.js?file=voltmeter.cpp&#34;&gt;&lt;/script&gt;&lt;br /&gt;&lt;br /&gt;&lt;h3 style=&#34;text-align: left;&#34;&gt;Demo&lt;/h3&gt;&lt;div style=&#34;text-align: left;&#34;&gt;I&#39;m on a GNU/Linux system, where the mbed is identified as &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;/dev/ttyACM0&lt;/span&gt;. A simple tool to use for connecting with it is &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;screen&lt;/span&gt; (eg. &lt;span style=&#34;font-family: &amp;quot;Courier New&amp;quot;,Courier,monospace;&#34;&gt;sudo screen /dev/ttyACM0&lt;/span&gt;). Pardon me for the bad quality of the video, it&#39;s the first time that I used YouTube capture with my phone and it didn&#39;t work as well as I expected :)&lt;/div&gt;&lt;div style=&#34;text-align: left;&#34;&gt;&lt;br /&gt;&lt;/div&gt;&lt;iframe allowfullscreen=&#34;&#34; frameborder=&#34;0&#34; height=&#34;315&#34; src=&#34;//www.youtube-nocookie.com/embed/Z-bx2zrV7SE?rel=0&#34; width=&#34;560&#34;&gt;&lt;/iframe&gt; &lt;br /&gt;&lt;h3 style=&#34;text-align: left;&#34;&gt;&amp;nbsp;&lt;/h3&gt;&lt;h3 style=&#34;text-align: left;&#34;&gt;Acknowledgements&lt;/h3&gt;&lt;div style=&#34;text-align: left;&#34;&gt;Special thanks to my good friend and Arduino hacker &lt;a href=&#34;http://efxa.org/&#34;&gt;efxa&lt;/a&gt;, for without his parts it wouldn&#39;t be possible to play with mbed.&lt;/div&gt;&lt;div style=&#34;text-align: left;&#34;&gt;&lt;br /&gt;&lt;/div&gt;&lt;h3 style=&#34;text-align: left;&#34;&gt;References &lt;/h3&gt;&lt;ul style=&#34;text-align: left;&#34;&gt;&lt;li&gt;&lt;i&gt;Bert Van Dam.&lt;/i&gt; &lt;a href=&#34;http://www.elektor.com/products/books/microcontrollers/arm-microcontrollers-1-%28uk%29.1625568.lynkx&#34;&gt;ARM Microcontrollers part 1 &lt;/a&gt;&lt;/li&gt;&lt;li&gt;&lt;i&gt;mbed handbook. &lt;/i&gt;&lt;a href=&#34;https://mbed.org/handbook/SerialPC&#34;&gt;Serial Communication with a PC&lt;/a&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;</description>
    </item>
  </channel>
</rss>
